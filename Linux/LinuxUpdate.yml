---
- name: Run commands on Linux
  hosts: linux
    
  tasks:
    - name: Updates a server
      apt: update_cache=yes
       
    - name: Upgrades a server
      apt: upgrade=dist
       
    - name: Check if a reboot is required
      register: file
      stat: path=/var/run/reboot-required get_md5=no
      
    - name: Reboot the server
      command: /sbin/reboot
      when: file.stat.exists == true